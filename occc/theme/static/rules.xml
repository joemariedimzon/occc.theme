<?xml version="1.0" encoding="UTF-8"?>
<!--start main rule, only theme if #visual-portal-wrapper exist -->
<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xi="http://www.w3.org/2001/XInclude"
    css:if-content="#visual-portal-wrapper">

    <rules css:if-content="#visual-portal-wrapper">
        <theme href="index.html"/>
        <!--HEAD SECTION-->
        <!-- Drop styles in the head - these are added back by including them from Plone -->
        <!-- <drop theme="/html/head/style | /html/head/script | /html/head/link | /html/head/title" /> -->
        <prepend theme="/html/head" content="/html/head/base | /html/head/link | /html/head/style | /html/head/script | /html/head/meta | /html/head/title" />
        <replace theme="/html" content="/html" attributes="lang"/>
        <merge theme="/html/body" content="/html/body" attributes="class"/>
        <merge theme="/html/body" content="/html/body" attributes="dir"/>
        <append css:theme="body" css:content="#plone-analytics"/>

        <replace css:theme-children="#portal-personaltools-wrapper"
            css:content-children="#portal-personaltools-wrapper"/>
        <replace css:theme-children="#portal-searchbox"
            css:content-children="#portal-searchbox"/>

        <replace css:theme="#portal-logo"
            css:content="#portal-logo"/>

        <!-- portal-personaltools -->
        <replace
            css:theme-children="#main-login"
            css:content="#portal-personaltools"
            />

        <!-- Central column -->
        <replace css:theme="#main-content-container" method="raw">

            <xsl:variable name="central">
                  <xsl:if test="//div[@id='portal-column-one'] and //div[@id='portal-column-two']">col-sm-6 col-md-8</xsl:if>
                  <xsl:if test="//div[@id='portal-column-two'] and not(//div[@id='portal-column-one'])">col-sm-9 col-md-10</xsl:if>
                  <xsl:if test="//div[@id='portal-column-one'] and not(//div[@id='portal-column-two'])">col-sm-9 col-md-10</xsl:if>
                  <xsl:if test="not(//div[@id='portal-column-one']) and not(//div[@id='portal-column-two'])">col-sm-12 col-md-12</xsl:if>
            </xsl:variable>

            <div class="{$central}">
                <div class="row">
                    <div class="col-xs-12">
                        <div id="banner-wrapper">
                            <img src="/++theme++occc.theme/img/banner.jpg" alt="" />
                        </div>
                        <xsl:apply-templates css:select="#edit-bar" />
                        <xsl:apply-templates css:select="#kssPortalMessage" />
                        <xsl:apply-templates css:select="#content" />
                    </div>
                </div>
                <footer class="row">
                    <div class="col-xs-12">
                        <xsl:copy-of css:select="#viewlet-below-content" />
                    </div>
                </footer>
            </div>
        </replace>
        <!-- Left column -->
        <rules css:if-content="#portal-column-one">
            <replace css:theme="#column1-container">
                <div class="col-sm-3 col-md-2 sidebar">
                    <aside id="portal-column-one">
                        <xsl:apply-templates css:select="#portal-logo" />
                        <br /><br />
                        <ul class="nav nav-sidebar">
                            <xsl:apply-templates css:select="#portal-globalnav > li" />
                        </ul>
                        <br/>
                        <xsl:apply-templates css:select="#portal-column-one > *" />
                    </aside>
                </div>
            </replace>
        </rules>
        <!-- Right column -->
        <rules css:if-content="#portal-column-two">
            <replace css:theme="#column2-container">
              <div class="col-sm-3 col-md-2">
                <aside id="portal-column-two">
                  <xsl:apply-templates css:select="#portal-column-two > *" />
                </aside>
              </div>
            </replace>
        </rules>

    </rules>
</rules>
